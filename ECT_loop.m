clf
clear
clc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
c0 = [0.14030E-04; 0.19473E-05; 0.14058E-04; 0.13976E-04; 0.19333E-05; 0.14015E-04];
c1 = [0.25651E-04; 0.20530E-05; 0.14148E-04; 0.14008E-04; 0.19811E-05; 0.13947E-04];
c2 = [0.15078E-04; 0.24339E-05; 0.15117E-04; 0.13787E-04; 0.17788E-05; 0.13840E-04];
c3 = [0.14121E-04; 0.20449E-05; 0.25686E-04; 0.13912E-04; 0.19747E-05; 0.14049E-04];
c4 = [0.15059E-04; 0.17610E-05; 0.13840E-04; 0.15054E-04; 0.24620E-05; 0.13829E-04];
c5 = [0.14144E-04; 0.24139E-05; 0.14127E-04; 0.14055E-04; 0.23182E-05; 0.14048E-04];
c6 = [0.13809E-04; 0.17333E-05; 0.15118E-04; 0.13772E-04; 0.24793E-05; 0.15089E-04];
c7 = [0.14089E-04; 0.20180E-05; 0.13994E-04; 0.25573E-04; 0.20326E-05; 0.14049E-04];
c8 = [0.13824E-04; 0.24513E-05; 0.13880E-04; 0.15019E-04; 0.17520E-05; 0.15104E-04];
c9 = [0.13969E-04; 0.20430E-05; 0.14089E-04; 0.14034E-04; 0.20021E-05; 0.25618E-04];
c_full = [0.28059E-04; 0.38946E-05; 0.28116E-04; 0.27952E-04; 0.38666E-05; 0.28031E-04];
c_mat = [c1, c2, c3, c4, c5, c6, c7, c8, c9];
I = ones(1, 9);
p = diag(I, 0);
s = zeros(6, 9);
 for n =1:9
     a = (c_mat(:, n)-c0)./c_full/p(:, n);
     s(:,n) = a(:, n);
 end
 b = s' * s + 0.001 .* diag(I, 0);
 d = inv(b);
 for n = 1:9
 	p_cap(:, n) = d * s' * (c_mat(:, n)-c0);
 end
 
 [x,y] = meshgrid(1:3,1:3);
 for n = 1:9
     z = [p_cap(1:3,n)';p_cap(4:6,n)';p_cap(7:9,n)'];
     subplot(3,3,n)
     imagesc(z)
 end
     